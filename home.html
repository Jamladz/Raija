<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Giftoo - NFT Gift Store</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    :root {
      --primary: #00d4ff;
      --primary-dark: #00b4d8;
      --secondary: #90e0ef;
      --accent: #caf0f8;
      --dark: #03045e;
      --darker: #023e8a;
      --light: #f8f9fa;
      --gray: #6c757d;
      --success: #4cc9f0;
      --warning: #ffd166;
      --danger: #ef476f;
      --common: #48cae4;
      --rare: #0096c7;
      --legendary: #0077b6;
      --epic: #023e8a;
      --border-radius: 16px;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      --transition: all 0.3s ease;
      --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      --icy-gradient: linear-gradient(135deg, #00d4ff 0%, #90e0ef 100%);
    }
    
    body {
      background: linear-gradient(135deg, var(--darker), var(--dark));
      color: var(--light);
      min-height: 100vh;
      padding-top: 100px;
      padding-bottom: 90px;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
      padding: 15px;
    }
    
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background: rgba(2, 62, 138, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow);
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .logo img {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
      background: var(--primary);
      padding: 8px;
      border: 2px solid var(--accent);
    }
    
    .logo h1 {
      font-size: 1.8rem;
      font-weight: 700;
      background: var(--icy-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
    }
    
    .wallet-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .ton-icon-header {
      font-size: 32px;
      color: #0088cc;
    }
    
    .wallet-btn {
      background: var(--icy-gradient);
      color: var(--dark);
      border: none;
      padding: 10px 20px;
      border-radius: 50px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition);
      box-shadow: var(--shadow);
    }
    
    .wallet-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 212, 255, 0.3);
    }
    
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 25px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .tab {
      background: rgba(255, 255, 255, 0.1);
      padding: 8px 20px;
      border-radius: 50px;
      cursor: pointer;
      transition: var(--transition);
      font-weight: 500;
      color: var(--light);
    }
    
    .tab.active, .tab:hover {
      background: var(--primary);
      color: var(--dark);
    }
    
    .nft-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .nft-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      overflow: hidden;
      transition: var(--transition);
      box-shadow: var(--shadow);
      position: relative;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .nft-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
      border-color: var(--primary);
    }
    
    .nft-image {
      width: 100%;
      height: 150px;
      object-fit: cover;
      display: block;
    }
    
    .nft-info {
      padding: 12px;
    }
    
    .nft-name {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 8px;
      text-align: center;
      color: var(--light);
    }
    
    .nft-rarity {
      font-size: 0.8rem;
      text-align: center;
      padding: 3px 8px;
      border-radius: 20px;
      margin-bottom: 8px;
      display: inline-block;
      width: 100%;
      font-weight: 600;
      color: white;
    }
    
    .common { background: var(--common); }
    .rare { background: var(--rare); }
    .legendary { background: var(--legendary); }
    .epic { background: var(--epic); }
    
    .nft-price {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 10px;
      color: var(--warning);
    }
    
    .free-btn {
      width: 100%;
      padding: 8px;
      background: var(--success);
      color: var(--dark);
      border: none;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 5px;
    }
    
    .free-btn:hover {
      background: #4cc9f0;
      transform: translateY(-2px);
    }
    
    .sold-out {
      background: var(--danger);
      color: white;
      text-align: center;
      padding: 6px;
      font-size: 0.8rem;
      font-weight: 600;
      border-radius: 4px;
    }
    
    .progress-container {
      padding: 0 5px;
    }
    
    .progress-bar {
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
      margin: 8px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: var(--icy-gradient);
      border-radius: 4px;
      transition: width 0.5s ease;
    }
    
    .sold-info {
      font-size: 0.75rem;
      text-align: center;
      color: var(--gray);
      display: flex;
      justify-content: space-between;
    }
    
    .sold-info span {
      font-weight: 500;
    }
    
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(2, 62, 138, 0.95);
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 100;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      color: var(--gray);
      cursor: pointer;
      transition: var(--transition);
      padding: 5px 10px;
      border-radius: 12px;
    }
    
    .nav-item.active, .nav-item:hover {
      color: var(--primary);
    }
    
    .nav-item i {
      font-size: 1.2rem;
    }
    
    .nav-item span {
      font-size: 0.8rem;
      font-weight: 500;
    }
    
    .coming-soon {
      text-align: center;
      padding: 40px 20px;
      color: var(--gray);
      font-size: 1rem;
    }
    
    .market-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: var(--transition);
      backdrop-filter: blur(10px);
    }
    
    .modal.active {
      opacity: 1;
      pointer-events: all;
    }
    
    .modal-content {
      background: var(--dark);
      border-radius: var(--border-radius);
      width: 95%;
      max-width: 400px;
      overflow: hidden;
      transform: translateY(20px);
      transition: var(--transition);
      max-height: 90vh;
      overflow-y: auto;
      border: 1px solid var(--primary);
      box-shadow: 0 10px 40px rgba(0, 212, 255, 0.2);
    }
    
    .modal.active .modal-content {
      transform: translateY(0);
    }
    
    .modal-header {
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(0, 0, 0, 0.2);
    }
    
    .modal-header h2 {
      font-size: 1.3rem;
      background: var(--icy-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .close-btn {
      background: none;
      border: none;
      color: var(--light);
      font-size: 1.5rem;
      cursor: pointer;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: var(--transition);
    }
    
    .close-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: rotate(90deg);
      color: var(--primary);
    }
    
    .modal-body {
      padding: 20px;
    }
    
    .modal-image {
      width: 100%;
      border-radius: var(--border-radius);
      margin-bottom: 20px;
      max-height: 250px;
      object-fit: cover;
      border: 1px solid var(--primary);
    }
    
    .modal-details {
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      padding: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.9rem;
    }
    
    .detail-label {
      color: var(--gray);
    }
    
    .detail-value {
      font-weight: 600;
      color: var(--light);
    }
    
    .quantity-selector {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 20px 0;
      justify-content: center;
    }
    
    .qty-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .qty-btn:hover {
      background: var(--primary);
      transform: scale(1.1);
    }
    
    .qty-input {
      width: 60px;
      text-align: center;
      padding: 10px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      border-radius: 10px;
      color: white;
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .modal-buy-btn {
      width: 100%;
      padding: 14px;
      background: var(--icy-gradient);
      color: var(--dark);
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      box-shadow: 0 5px 15px rgba(0, 212, 255, 0.3);
    }
    
    .modal-buy-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 212, 255, 0.5);
    }
    
    .modal-buy-btn:disabled {
      background: var(--gray);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
      color: white;
    }
    
    .ton-icon {
      display: inline-block;
      width: 20px;
      height: 20px;
      background: #0088cc;
      border-radius: 50%;
      position: relative;
    }
    
    .ton-icon::after {
      content: "TON";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 7px;
      font-weight: bold;
      color: white;
    }
    
    .ton-coin-icon {
      width: 16px;
      height: 16px;
      background: #0088cc;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    
    .ton-coin-icon::after {
      content: "TON";
      position: absolute;
      font-size: 6px;
      font-weight: bold;
      color: white;
    }
    
    .profile-page {
      display: none;
    }
    
    .profile-header {
      text-align: center;
      margin-bottom: 25px;
      position: relative;
    }
    
    .profile-avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 12px;
      border: 3px solid var(--primary);
      box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
    }
    
    .username-container {
      width: 100%;
      overflow: hidden;
      white-space: nowrap;
      text-align: center;
    }
    
    .marquee {
      display: inline-block;
      padding-left: 100%;
      animation: marquee 15s linear infinite;
    }
    
    @keyframes marquee {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }
    
    .profile-info {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .info-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      align-items: center;
      font-size: 0.9rem;
    }
    
    .info-label {
      color: var(--gray);
    }
    
    .info-value {
      font-weight: 600;
      color: var(--light);
    }
    
    .referral-section {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      padding: 20px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .referral-title {
      margin-bottom: 12px;
      font-size: 1.2rem;
      color: var(--primary);
      font-weight: 700;
    }
    
    .referral-link-container {
      display: flex;
      margin-bottom: 12px;
      border-radius: var(--border-radius);
      overflow: hidden;
    }
    
    .referral-link {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      padding: 10px 12px;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      text-align: right;
      font-size: 0.85rem;
      color: var(--light);
    }
    
    .copy-btn {
      background: var(--primary);
      color: var(--dark);
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      font-size: 0.85rem;
    }
    
    .copy-btn:hover {
      background: var(--primary-dark);
    }
    
    .referral-note {
      color: var(--warning);
      font-size: 0.85rem;
      margin-top: 12px;
      line-height: 1.5;
    }
    
    .wallet-connected {
      background: var(--success);
    }
    
    .ton-connect-container {
      width: 100%;
      margin: 15px 0;
    }
    
    .ton-connect-button {
      width: 100%;
      background: var(--icy-gradient);
      color: var(--dark);
      border: none;
      padding: 12px;
      border-radius: 10px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 5px 15px rgba(0, 212, 255, 0.3);
    }
    
    .ton-connect-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 212, 255, 0.5);
    }
    
    .ton-connect-button.connected {
      background: var(--success);
      color: white;
    }
    
    .wallet-status {
      margin-top: 8px;
      font-size: 0.85rem;
      text-align: center;
      padding: 8px;
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.05);
    }
    
    .connected-status {
      color: var(--success);
    }
    
    .disconnected-status {
      color: var(--danger);
    }
    
    .market-page {
      display: none;
    }
    
    .market-header {
      text-align: center;
      margin-bottom: 25px;
    }
    
    .market-header h2 {
      font-size: 1.5rem;
      margin-bottom: 12px;
      color: var(--primary);
    }
    
    .market-feature {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 20px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: var(--primary);
    }
    
    .feature-title {
      font-size: 1.3rem;
      margin-bottom: 12px;
      color: var(--light);
    }
    
    .feature-description {
      color: var(--gray);
      margin-bottom: 15px;
      line-height: 1.5;
      font-size: 0.95rem;
    }
    
    .countdown {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin: 20px 0;
    }
    
    .countdown-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 50px;
    }
    
    .countdown-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
    }
    
    .countdown-label {
      font-size: 0.85rem;
      color: var(--gray);
    }
    
    .my-nfts-section {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .section-title {
      font-size: 1.3rem;
      margin-bottom: 15px;
      color: var(--primary);
      text-align: center;
    }
    
    .nfts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
      gap: 15px;
    }
    
    .user-nft-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      overflow: hidden;
      transition: var(--transition);
      box-shadow: var(--shadow);
      position: relative;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .user-nft-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      border-color: var(--primary);
    }
    
    .user-nft-image {
      width: 100%;
      height: 130px;
      object-fit: cover;
      display: block;
    }
    
    .user-nft-info {
      padding: 10px;
    }
    
    .user-nft-name {
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 5px;
      text-align: center;
      color: var(--light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .user-nft-rarity {
      font-size: 0.7rem;
      text-align: center;
      padding: 2px 6px;
      border-radius: 20px;
      margin-bottom: 5px;
      display: inline-block;
      width: 100%;
      font-weight: 600;
      color: white;
    }
    
    .profile-nft-modal .modal-content {
      max-width: 400px;
    }
    
    .nft-actions {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 15px;
    }
    
    .action-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.05);
      border: none;
      border-radius: var(--border-radius);
      padding: 12px 8px;
      color: var(--light);
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
      flex: 1;
    }
    
    .action-btn:hover {
      background: rgba(0, 212, 255, 0.2);
      transform: translateY(-3px);
    }
    
    .action-btn i {
      font-size: 1.5rem;
      margin-bottom: 6px;
    }
    
    .action-btn.send i { color: var(--success); }
    .action-btn.sell i { color: var(--warning); }
    .action-btn.share i { color: var(--primary); }
    
    .action-btn span {
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .first-gift {
      position: relative;
      border: 2px solid var(--warning);
    }
    
    .first-gift::after {
      content: "FEATURED";
      position: absolute;
      top: 8px;
      left: 8px;
      background: var(--warning);
      color: black;
      font-weight: bold;
      font-size: 0.6rem;
      padding: 2px 6px;
      border-radius: 20px;
      z-index: 10;
    }
    
    .free-gift {
      position: relative;
      border: 2px solid var(--success);
    }
    
    .free-gift::after {
      content: "FREE";
      position: absolute;
      top: 8px;
      left: 8px;
      background: var(--success);
      color: var(--dark);
      font-weight: bold;
      font-size: 0.6rem;
      padding: 2px 8px;
      border-radius: 20px;
      z-index: 10;
    }
    
    /* New TON icon style */
    .ton-icon-img {
      width: 16px;
      height: 16px;
      vertical-align: middle;
    }
    
    /* Coming Soon Page Styles */
    .coming-soon-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 60vh;
      text-align: center;
    }
    
    .coming-soon-image {
      width: 200px;
      height: 200px;
      object-fit: contain;
      margin-bottom: 30px;
    }
    
    .coming-soon-text {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary);
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
      margin-bottom: 20px;
    }
    
    /* Upgrade Button Styles */
    .upgrade-btn {
      width: 100%;
      padding: 10px;
      background: var(--icy-gradient);
      color: var(--dark);
      border: none;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .upgrade-btn:hover {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary) 100%);
      transform: translateY(-2px);
    }
    
    /* Glow effects */
    .glow {
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes glow {
      from {
        box-shadow: 0 0 5px rgba(0, 212, 255, 0.5);
      }
      to {
        box-shadow: 0 0 20px rgba(0, 212, 255, 0.8);
      }
    }
    
    /* Pulse animation for free gifts */
    .pulse {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(76, 201, 240, 0.7);
      }
      70% {
        box-shadow: 0 0 0 10px rgba(76, 201, 240, 0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(76, 201, 240, 0);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <img src="https://i.suar.me/3AVmL/l" alt="Giftoo Logo">
        <h1>Giftoo</h1>
      </div>
      <div class="wallet-section">
        <i class="fab fa-ton ton-icon-header"></i>
        <div id="ton-connect-button"></div>
      </div>
    </header>

    <!-- Shop Page -->
    <div id="shop-page" class="page">
      <div class="tabs">
        <div class="tab active" data-filter="all">All</div>
        <div class="tab" data-filter="common">Common</div>
        <div class="tab" data-filter="rare">Rare</div>
        <div class="tab" data-filter="legendary">Legendary</div>
        <div class="tab" data-filter="epic">Epic</div>
      </div>

      <div class="nft-grid" id="nft-grid">
        <!-- NFTs will be populated by JavaScript -->
      </div>
    </div>

    <!-- Profile Page -->
    <div id="profile-page" class="page profile-page">
      <div class="profile-header">
        <img src="https://via.placeholder.com/100/ff6b6b/ffffff?text=U" class="profile-avatar" id="profile-avatar" alt="Profile">
        <div class="username-container">
          <h2 id="profile-username">Telegram User</h2>
        </div>
      </div>
      
      <div class="ton-connect-container">
        <button class="ton-connect-button" id="ton-connect-button-profile">
          <span class="ton-icon"></span> Connect TON Wallet
        </button>
        <div class="wallet-status" id="wallet-status">
          <span class="disconnected-status">Wallet not connected</span>
        </div>
      </div>
      
      <div class="referral-section">
        <h3 class="referral-title">Referral Program</h3>
        <div class="referral-link-container">
          <div class="referral-link" id="referral-link">https://t.me/GiftooBot?start=ref_username</div>
          <button class="copy-btn" id="copy-referral-btn">
            <i class="fas fa-copy"></i> Copy
          </button>
        </div>
        <p class="referral-note">Earn 10% commission for every purchase made through your referral link!</p>
      </div>
      
      <!-- My NFTs section -->
      <div class="my-nfts-section">
        <h3 class="section-title">My Gift Collection</h3>
        <div class="nfts-grid" id="user-nfts-grid">
          <!-- Purchased NFTs will appear here -->
        </div>
      </div>
    </div>
    
    <!-- Market Page -->
    <div id="market-page" class="page market-page">
      <div class="coming-soon-container">
        <img src="https://i.suar.me/dpd3e/l" alt="Coming Soon" class="coming-soon-image">
        <div class="coming-soon-text">Coming Soon</div>
      </div>
    </div>
  </div>

  <div class="bottom-nav">
    <div class="nav-item active" data-page="shop">
      <i class="fas fa-gift"></i>
      <span>Store</span>
    </div>
    <div class="nav-item" data-page="market">
      <i class="fas fa-store"></i>
      <span>Market</span>
    </div>
    <div class="nav-item" data-page="profile">
      <i class="fas fa-user"></i>
      <span>Profile</span>
    </div>
  </div>

  <!-- NFT Purchase Modal -->
  <div class="modal" id="nft-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modal-nft-name">Common Gift #1</h2>
        <button class="close-btn" id="close-modal">×</button>
      </div>
      <div class="modal-body">
        <img src="" alt="NFT" class="modal-image" id="modal-nft-image">
        <div class="modal-details">
          <div class="detail-row">
            <span class="detail-label">Rarity:</span>
            <span class="detail-value" id="modal-nft-rarity">Common</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Price:</span>
            <span class="detail-value">
              <img src="https://i.suar.me/ppxV6/l" class="ton-icon-img" alt="TON">
              <span id="price-value">0.1</span>
            </span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Total:</span>
            <span class="detail-value" id="modal-nft-quantity">25,000</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Sold:</span>
            <span class="detail-value" id="modal-nft-sold">12570</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Available:</span>
            <span class="detail-value" id="modal-nft-available">12430</span>
          </div>
        </div>
        
        <div class="quantity-selector">
          <button class="qty-btn" id="qty-minus">-</button>
          <input type="text" class="qty-input" value="1" id="nft-quantity">
          <button class="qty-btn" id="qty-plus">+</button>
        </div>
        
        <button class="modal-buy-btn" id="buy-btn">
          <i class="fas fa-shopping-cart"></i>
          Buy Now
        </button>
      </div>
    </div>
  </div>

  <!-- Profile NFT Modal -->
  <div class="modal profile-nft-modal" id="profile-nft-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="profile-modal-nft-name">Giftoo NFT</h2>
        <button class="close-btn" id="close-profile-modal">×</button>
      </div>
      <div class="modal-body">
        <img src="" alt="NFT" class="modal-image" id="profile-modal-nft-image">
        <div class="modal-details">
          <div class="detail-row">
            <span class="detail-label">Rarity:</span>
            <span class="detail-value" id="profile-modal-nft-rarity">Legendary</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Purchase Date:</span>
            <span class="detail-value" id="profile-modal-purchase-date">2025-07-08</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Purchase Price:</span>
            <span class="detail-value">
              <img src="https://i.suar.me/ppxV6/l" class="ton-icon-img" alt="TON">
              <span id="profile-modal-price">20.00</span>
            </span>
          </div>
          <button class="upgrade-btn" id="upgrade-btn">
            <i class="fas fa-arrow-up"></i> Upgrade
          </button>
        </div>
        
        <div class="nft-actions">
          <button class="action-btn send">
            <i class="fas fa-paper-plane"></i>
            <span>Send</span>
          </button>
          <button class="action-btn sell">
            <i class="fas fa-tag"></i>
            <span>Sell</span>
          </button>
          <button class="action-btn share">
            <i class="fas fa-share-alt"></i>
            <span>Share</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Updated NFT data with The Seer as a free gift
    const nfts = [
      {
        id: 0,
        name: "The Seer",
        image: "https://i.suar.me/evjXP/m",
        price: 0,
        total: 10000,
        sold: 0,
        rarity: "Epic",
        rarityClass: "epic",
        isFreeGift: true
      },
      {
        id: 1,
        name: "Teddy of Room 1408",
        image: "https://i.suar.me/PzlGp/m",
        price: 20,
        total: 1000,
        sold: 913,
        rarity: "Legendary",
        rarityClass: "legendary",
        isFirstGift: true
      },
      {
        id: 2,
        name: "Icey Hug",
        image: "https://i.suar.me/9lVXw/m",
        price: 0.1,
        total: 25000,
        sold: 23424,
        rarity: "Common",
        rarityClass: "common"
      },
      {
        id: 3,
        name: "Vow Capsule",
        image: "https://i.suar.me/Yvrj5/m",
        price: 0.25,
        total: 20000,
        sold: 18643,
        rarity: "Common",
        rarityClass: "common"
      },
      {
        id: 4,
        name: "Pépé B2",
        image: "https://i.suar.me/Wv8rr/m",
        price: 0.5,
        total: 10000,
        sold: 9754,
        rarity: "Rare",
        rarityClass: "rare"
      },
      {
        id: 5,
        name: "Rider of Liberty",
        image: "https://i.suar.me/dpdXJ/m",
        price: 5,
        total: 3000,
        sold: 2145,
        rarity: "Legendary",
        rarityClass: "legendary"
      }
    ];

    // Updated NFT images for profile view
    const profileNftImages = {
      0: "https://i.suar.me/evjXP/m",
      1: "https://i.suar.me/PzlGp/m",
      2: "https://i.suar.me/9lVXw/m",
      3: "https://i.suar.me/Yvrj5/m",
      4: "https://i.suar.me/Wv8rr/m",
      5: "https://i.suar.me/dpdXJ/m"
    };

    // DOM elements
    const nftGrid = document.getElementById('nft-grid');
    const modal = document.getElementById('nft-modal');
    const closeModal = document.getElementById('close-modal');
    const modalImage = document.getElementById('modal-nft-image');
    const modalName = document.getElementById('modal-nft-name');
    const modalRarity = document.getElementById('modal-nft-rarity');
    const modalPrice = document.getElementById('price-value');
    const modalQuantity = document.getElementById('modal-nft-quantity');
    const modalSold = document.getElementById('modal-nft-sold');
    const modalAvailable = document.getElementById('modal-nft-available');
    const qtyInput = document.getElementById('nft-quantity');
    const qtyPlus = document.getElementById('qty-plus');
    const qtyMinus = document.getElementById('qty-minus');
    const buyBtn = document.getElementById('buy-btn');
    const navItems = document.querySelectorAll('.nav-item');
    const tabs = document.querySelectorAll('.tab');
    const shopPage = document.getElementById('shop-page');
    const profilePage = document.getElementById('profile-page');
    const marketPage = document.getElementById('market-page');
    const profileUsername = document.getElementById('profile-username');
    const profileAvatar = document.getElementById('profile-avatar');
    const referralLink = document.getElementById('referral-link');
    const copyReferralBtn = document.getElementById('copy-referral-btn');
    const walletStatus = document.getElementById('wallet-status');
    const tonConnectButtonProfile = document.getElementById('ton-connect-button-profile');
    const countdownDays = document.getElementById('days');
    const countdownHours = document.getElementById('hours');
    const countdownMinutes = document.getElementById('minutes');
    const countdownSeconds = document.getElementById('seconds');
    const userNftsGrid = document.getElementById('user-nfts-grid');
    const profileModal = document.getElementById('profile-nft-modal');
    const closeProfileModal = document.getElementById('close-profile-modal');
    const profileModalImage = document.getElementById('profile-modal-nft-image');
    const profileModalName = document.getElementById('profile-modal-nft-name');
    const profileModalRarity = document.getElementById('profile-modal-nft-rarity');
    const profileModalPrice = document.getElementById('profile-modal-price');
    const profileModalPurchaseDate = document.getElementById('profile-modal-purchase-date');
    const sendBtn = document.querySelector('.action-btn.send');
    const sellBtn = document.querySelector('.action-btn.sell');
    const shareBtn = document.querySelector('.action-btn.share');
    const upgradeBtn = document.getElementById('upgrade-btn');

    // TON Connect variables
    let tonConnectUI;
    let wallet = null;
    const recipientAddress = 'UQCTZAMbXoN5T43K9gJXH8GYWBmIstXrUrdoV9kv3btN1Ad3';
    
    // User's purchased NFTs (stored in localStorage)
    let purchasedNFTs = JSON.parse(localStorage.getItem('purchasedNFTs')) || [];
    
    // Format numbers with commas
    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // Render NFTs to the grid
    function renderNFTs(nftList) {
      nftGrid.innerHTML = '';
      
      nftList.forEach(nft => {
        const available = nft.total - nft.sold;
        const isSoldOut = available <= 0;
        const percentageSold = (nft.sold / nft.total) * 100;
        
        const nftCard = document.createElement('div');
        nftCard.className = `nft-card ${nft.isFirstGift ? 'first-gift' : ''} ${nft.isFreeGift ? 'free-gift pulse' : ''}`;
        nftCard.innerHTML = `
          <img src="${nft.image}" alt="${nft.name}" class="nft-image">
          <div class="nft-info">
            <h3 class="nft-name">${nft.name}</h3>
            <div class="nft-rarity ${nft.rarityClass}">${nft.rarity}</div>
            ${nft.price > 0 ? `
              <div class="nft-price">
                <img src="https://i.suar.me/ppxV6/l" class="ton-icon-img" alt="TON">
                ${nft.price}
              </div>
              <div class="progress-container">
                <div class="progress-bar">
                  <div class="progress-fill" style="width: ${percentageSold}%"></div>
                </div>
                <div class="sold-info">
                  <span>Sold: ${formatNumber(nft.sold)}</span>
                  <span>Available: ${formatNumber(available)}</span>
                </div>
              </div>
              ${isSoldOut ? '<div class="sold-out">Sold Out</div>' : ''}
            ` : `
              <button class="free-btn" data-id="${nft.id}">
                <i class="fas fa-gift"></i> Claim Free
              </button>
            `}
          </div>
        `;
        
        if (nft.price > 0) {
          nftCard.addEventListener('click', () => openModal(nft));
        } else {
          const freeBtn = nftCard.querySelector('.free-btn');
          freeBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            claimFreeNFT(nft);
          });
        }
        
        nftGrid.appendChild(nftCard);
      });
    }
    
    // Claim free NFT
    function claimFreeNFT(nft) {
      // Check if already claimed
      const alreadyClaimed = purchasedNFTs.some(item => item.id === nft.id);
      if (alreadyClaimed) {
        alert('You have already claimed this free NFT!');
        return;
      }
      
      // Add to purchased NFTs
      const purchase = {
        ...nft,
        purchaseDate: new Date().toISOString().split('T')[0],
        quantity: 1
      };
      
      purchasedNFTs.push(purchase);
      
      // Update localStorage
      localStorage.setItem('purchasedNFTs', JSON.stringify(purchasedNFTs));
      
      // Update sold count
      const nftIndex = nfts.findIndex(item => item.id === nft.id);
      if (nftIndex !== -1) {
        nfts[nftIndex].sold += 1;
      }
      
      // Re-render NFTs and user NFTs
      renderNFTs(nfts);
      renderUserNFTs();
      
      alert(`🎉 You successfully claimed "${nft.name}" for free!`);
    }
    
    // Render user's NFTs in profile
    function renderUserNFTs() {
      userNftsGrid.innerHTML = '';
      
      if (purchasedNFTs.length === 0) {
        userNftsGrid.innerHTML = `
          <div class="coming-soon" style="grid-column: 1/-1">
            <p>You haven't purchased any NFTs yet</p>
            <p>Visit the store to buy your first NFT!</p>
          </div>
        `;
        return;
      }
      
      purchasedNFTs.forEach(nft => {
        const nftCard = document.createElement('div');
        nftCard.className = 'user-nft-card';
        nftCard.innerHTML = `
          <img src="${profileNftImages[nft.id]}" alt="${nft.name}" class="user-nft-image">
          <div class="user-nft-info">
            <h3 class="user-nft-name">${nft.name}</h3>
            <div class="user-nft-rarity ${nft.rarityClass}">${nft.rarity}</div>
          </div>
        `;
        
        nftCard.addEventListener('click', () => openProfileModal(nft));
        userNftsGrid.appendChild(nftCard);
      });
    }

    // Open NFT modal
    function openModal(nft) {
      const available = nft.total - nft.sold;
      const isSoldOut = available <= 0;
      
      modalImage.src = nft.image;
      modalName.textContent = nft.name;
      modalRarity.textContent = nft.rarity;
      modalPrice.textContent = nft.price;
      modalQuantity.textContent = formatNumber(nft.total);
      modalSold.textContent = formatNumber(nft.sold);
      modalAvailable.textContent = formatNumber(available);
      qtyInput.value = 1;
      
      // Disable buy button if sold out or wallet not connected
      buyBtn.disabled = isSoldOut || !wallet;
      buyBtn.textContent = isSoldOut ? "Sold Out" : "Buy Now";
      
      modal.classList.add('active');
    }
    
    // Open profile NFT modal
    function openProfileModal(nft) {
      profileModalImage.src = profileNftImages[nft.id];
      profileModalName.textContent = nft.name;
      profileModalRarity.textContent = nft.rarity;
      profileModalPrice.textContent = nft.price.toFixed(2);
      profileModalPurchaseDate.textContent = nft.purchaseDate;
      
      profileModal.classList.add('active');
    }

    // Close modal
    function closeModalFunc() {
      modal.classList.remove('active');
    }
    
    // Close profile modal
    function closeProfileModalFunc() {
      profileModal.classList.remove('active');
    }

    // Filter NFTs by rarity
    function filterNFTs(rarity) {
      if (rarity === 'all') {
        renderNFTs(nfts);
      } else {
        const filtered = nfts.filter(nft => nft.rarity.toLowerCase() === rarity);
        renderNFTs(filtered);
      }
    }

    // Initialize TON Connect with proper error handling
    function initTonConnect() {
      try {
        tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
          manifestUrl: 'https://jamladz.github.io/Raija/tonconnect-manifest.json',
          buttonRootId: 'ton-connect-button',
          language: 'en',
          uiPreferences: {
            theme: 'DARK',
            borderRadius: 'm'
          }
        });
        
        tonConnectUI.onStatusChange(userWallet => {
          wallet = userWallet;
          updateWalletStatus();
          
          if (wallet) {
            // Update UI with wallet info
            const address = wallet.account.address;
            const shortAddress = address.substring(0, 6) + '...' + address.substring(address.length - 4);
            walletStatus.innerHTML = `<span class="connected-status">✅ Wallet connected: ${shortAddress}</span>`;
            
            // Update profile button
            tonConnectButtonProfile.textContent = 'Wallet Connected';
            tonConnectButtonProfile.classList.add('connected');
          } else {
            // Reset wallet info
            walletStatus.innerHTML = '<span class="disconnected-status">Wallet not connected</span>';
            tonConnectButtonProfile.textContent = 'Connect TON Wallet';
            tonConnectButtonProfile.classList.remove('connected');
          }
        });
        
        // Check if wallet is already connected
        tonConnectUI.connectionRestored.then(() => {
          console.log('Connection restored');
        }).catch(err => {
          console.error('Connection restore error:', err);
        });
        
      } catch (error) {
        console.error('TON Connect initialization error:', error);
        walletStatus.innerHTML = '<span class="disconnected-status">Error connecting to wallet</span>';
      }
    }
    
    // Update wallet connection status
    function updateWalletStatus() {
      if (wallet) {
        buyBtn.disabled = false;
      } else {
        buyBtn.disabled = true;
      }
    }

    // Send transaction
    async function sendTransaction(amount) {
      if (!wallet) return;
      
      const tx = {
        validUntil: Math.floor(Date.now() / 1000) + 600,
        messages: [
          {
            address: recipientAddress,
            amount: (amount * 1000000000).toString() // Convert TON to nanoton
          }
        ]
      };

      try {
        const result = await tonConnectUI.sendTransaction(tx);
        alert(`✅ Payment sent successfully! (${amount} TON)`);
        closeModalFunc();
        return true;
      } catch (error) {
        alert(`❌ Payment failed: ${error.message}`);
        return false;
      }
    }

    // Detect Telegram user
    function detectTelegramUser() {
      if (window.Telegram && window.Telegram.WebApp) {
        const user = window.Telegram.WebApp.initDataUnsafe.user;
        if (user) {
          // Update profile
          const username = user.username ? `@${user.username}` : 'Telegram User';
          profileUsername.textContent = username;
          
          // Generate referral link
          const refLink = `https://t.me/GiftooBot?start=ref_${user.username || 'user'}`;
          referralLink.textContent = refLink;
          
          // Set avatar if available
          if (user.photo_url) {
            profileAvatar.src = user.photo_url;
          }
          
          // Add marquee effect for Telegram username
          profileUsername.classList.add('marquee');
          
          return true;
        }
      }
      return false;
    }
    
    // Market countdown timer
    function startCountdown() {
      const launchDate = new Date();
      launchDate.setDate(launchDate.getDate() + 45); // Set to 45 days
      
      function updateCountdown() {
        const now = new Date();
        const diff = launchDate - now;
        
        if (diff <= 0) {
          clearInterval(timer);
          return;
        }
        
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        
        countdownDays.textContent = days.toString().padStart(2, '0');
        countdownHours.textContent = hours.toString().padStart(2, '0');
        countdownMinutes.textContent = minutes.toString().padStart(2, '0');
        countdownSeconds.textContent = seconds.toString().padStart(2, '0');
      }
      
      updateCountdown();
      const timer = setInterval(updateCountdown, 1000);
    }
    
    // Simulate NFT purchase
    function purchaseNFT(nft, quantity) {
      // Find the NFT in our array
      const nftIndex = nfts.findIndex(item => item.id === nft.id);
      
      if (nftIndex === -1) return false;
      
      // Update sold count
      nfts[nftIndex].sold += quantity;
      
      // Add to purchased NFTs
      const purchase = {
        ...nft,
        purchaseDate: new Date().toISOString().split('T')[0],
        quantity: quantity
      };
      
      purchasedNFTs.push(purchase);
      
      // Update localStorage
      localStorage.setItem('purchasedNFTs', JSON.stringify(purchasedNFTs));
      
      // Re-render NFTs and user NFTs
      renderNFTs(nfts);
      renderUserNFTs();
      
      return true;
    }

    // Initialize the page
    function init() {
      // Render NFTs
      renderNFTs(nfts);
      
      // Render user NFTs
      renderUserNFTs();
      
      // Initialize TON Connect
      initTonConnect();
      
      // Modal events
      closeModal.addEventListener('click', closeModalFunc);
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          closeModalFunc();
        }
      });
      
      closeProfileModal.addEventListener('click', closeProfileModalFunc);
      profileModal.addEventListener('click', (e) => {
        if (e.target === profileModal) {
          closeProfileModalFunc();
        }
      });
      
      // Quantity selector
      qtyPlus.addEventListener('click', () => {
        qtyInput.value = parseInt(qtyInput.value) + 1;
      });
      
      qtyMinus.addEventListener('click', () => {
        if (parseInt(qtyInput.value) > 1) {
          qtyInput.value = parseInt(qtyInput.value) - 1;
        }
      });
      
      // Buy button
      buyBtn.addEventListener('click', async () => {
        const quantity = parseInt(qtyInput.value);
        const nftPrice = parseFloat(modalPrice.textContent);
        const totalPrice = quantity * nftPrice;
        
        if (!wallet) {
          alert('Please connect your wallet first!');
          return;
        }
        
        // Get the current NFT data
        const currentNFT = nfts.find(nft => nft.name === modalName.textContent);
        if (!currentNFT) return;
        
        // Send transaction
        const success = await sendTransaction(totalPrice);
        
        if (success) {
          // Purchase NFT
          purchaseNFT(currentNFT, quantity);
          alert(`🎉 You successfully purchased ${quantity} ${currentNFT.name} NFT(s)!`);
        }
      });
      
      // Profile NFT actions
      sendBtn.addEventListener('click', () => {
        alert('Send feature coming soon!');
      });
      
      sellBtn.addEventListener('click', () => {
        alert('Sell feature coming soon!');
      });
      
      shareBtn.addEventListener('click', () => {
        alert('Share feature coming soon!');
      });
      
      // Upgrade button
      upgradeBtn.addEventListener('click', () => {
        alert('Upgrade feature coming soon!');
      });
      
      // Bottom navigation
      navItems.forEach(item => {
        item.addEventListener('click', () => {
          // Remove active class from all
          navItems.forEach(i => i.classList.remove('active'));
          
          // Add active class to clicked
          item.classList.add('active');
          
          const page = item.getAttribute('data-page');
          
          if (page === 'shop') {
            shopPage.style.display = 'block';
            profilePage.style.display = 'none';
            marketPage.style.display = 'none';
          } else if (page === 'profile') {
            shopPage.style.display = 'none';
            profilePage.style.display = 'block';
            marketPage.style.display = 'none';
          } else if (page === 'market') {
            shopPage.style.display = 'none';
            profilePage.style.display = 'none';
            marketPage.style.display = 'block';
          }
        });
      });
      
      // Rarity tabs
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          // Remove active class from all
          tabs.forEach(t => t.classList.remove('active'));
          
          // Add active class to clicked
          tab.classList.add('active');
          
          const filter = tab.getAttribute('data-filter');
          filterNFTs(filter);
        });
      });
      
      // Profile TON Connect button
      tonConnectButtonProfile.addEventListener('click', () => {
        if (tonConnectUI) {
          tonConnectUI.openModal();
        }
      });
      
      // Copy referral link
      copyReferralBtn.addEventListener('click', () => {
        const link = referralLink.textContent;
        navigator.clipboard.writeText(link)
          .then(() => {
            alert('Referral link copied!');
          })
          .catch(err => {
            console.error('Failed to copy: ', err);
          });
      });
      
      // Detect Telegram user
      if (detectTelegramUser()) {
        console.log('Telegram user detected');
      }
      
      // Start market countdown
      startCountdown();
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
